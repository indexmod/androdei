<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>360 панорама — море и паруса</title>
<style>
  html,body{height:100%;margin:0}
  body{background:#78b7ff;overflow:hidden}
  .stage{position:fixed;inset:0}
  svg{width:100%;height:100%;}
  .hint{
    position:fixed;left:50%;bottom:1rem;transform:translateX(-50%);
    font:13px/1.3 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    color:#ffffffcc;background:#00000033;border-radius:10px;padding:.35rem .6rem
  }
</style>
</head>
<body>
<div class="stage">
  <svg viewBox="0 0 2000 1000" preserveAspectRatio="xMidYMid slice">
    <defs>
      <linearGradient id="sky" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0" stop-color="#73b1ff"/>
        <stop offset="1" stop-color="#a6d0ff"/>
      </linearGradient>

      <!-- Облако -->
      <g id="cloud">
        <ellipse cx="0" cy="0" rx="60" ry="36" fill="#fff"/>
        <ellipse cx="50" cy="-8" rx="40" ry="28" fill="#fff"/>
        <ellipse cx="-50" cy="-10" rx="45" ry="30" fill="#fff"/>
        <ellipse cx="12" cy="12" rx="70" ry="32" fill="#fff"/>
      </g>

      <!-- Только паруса -->
      <g id="sails">
        <rect x="-2" y="-40" width="4" height="40" fill="#333"/>
        <polygon points="0,-40 0,-15 -25,-15" fill="#fff"/>
        <polygon points="0,-35 0,-15 25,-15" fill="#f2f2f2"/>
      </g>

      <symbol id="cloudBand" viewBox="0 0 2000 400">
        <use href="#cloud" x="150" y="140" />
        <use href="#cloud" x="360" y="110" transform="scale(1.1)"/>
        <use href="#cloud" x="620" y="160" transform="scale(.9)"/>
        <use href="#cloud" x="880" y="120" transform="scale(1.2)"/>
        <use href="#cloud" x="1140" y="150" transform="scale(1.0)"/>
        <use href="#cloud" x="1400" y="130" transform="scale(1.15)"/>
        <use href="#cloud" x="1680" y="155" transform="scale(.95)"/>
      </symbol>

      <symbol id="sailsBand" viewBox="0 0 2000 200">
        <use href="#sails" x="200" y="60" transform="scale(1.2)"/>
        <use href="#sails" x="600" y="70" transform="scale(0.9)"/>
        <use href="#sails" x="1000" y="65" transform="scale(1.1)"/>
        <use href="#sails" x="1400" y="60" transform="scale(1)"/>
        <use href="#sails" x="1800" y="75" transform="scale(1.3)"/>
      </symbol>
    </defs>

    <!-- Небо -->
    <rect x="0" y="0" width="2000" height="1000" fill="url(#sky)"/>

    <!-- ДАЛЬНИЙ СЛОЙ: облака -->
    <g id="layer-clouds" opacity="0.9">
      <use href="#cloudBand" x="0" y="80"/>
      <use href="#cloudBand" x="2000" y="80"/>
    </g>

    <!-- СРЕДНИЙ СЛОЙ: море -->
    <rect id="sea" x="0" y="500" width="2000" height="500" fill="#0077b6"/>

    <!-- ПЕРЕДНИЙ СЛОЙ: только паруса -->
    <g id="layer-sails">
      <use href="#sailsBand" x="0" y="480"/>
      <use href="#sailsBand" x="2000" y="480"/>
    </g>
  </svg>
</div>

<div class="hint">Потяните мышью или пальцем для обзора 360°</div>

<script>
(function(){
  const W = 2000;
  const clouds = document.getElementById('layer-clouds');
  const sails  = document.getElementById('layer-sails');
  let pan = 0, dragging=false,lastX=0,velocity=0,rafId;

  const setTransforms=()=>{
    const c=pan*0.3, s=pan*0.8;
    const wrap=v=>((v%W)+W)%W;
    clouds.setAttribute('transform',`translate(${-wrap(c)},0)`);
    sails.setAttribute('transform',`translate(${-wrap(s)},0)`);
  };

  const onDown=x=>{dragging=true;lastX=x;velocity=0;cancelAnimationFrame(rafId)};
  const onMove=x=>{
    if(!dragging) return;
    const dx=x-lastX; lastX=x; pan-=dx; velocity=-dx; setTransforms();
  };
  const onUp=()=>{
    if(!dragging) return; dragging=false;
    const friction=0.95;
    const tick=()=>{
      velocity*=friction;
      if(Math.abs(velocity)<0.05) return;
      pan+=velocity; setTransforms();
      rafId=requestAnimationFrame(tick);
    };
    rafId=requestAnimationFrame(tick);
  };

  let auto=0.1;
  function autoTick(){
    if(!dragging){pan+=auto;setTransforms();}
    requestAnimationFrame(autoTick);
  }
  requestAnimationFrame(autoTick);

  addEventListener('mousedown',e=>onDown(e.clientX));
  addEventListener('mousemove',e=>onMove(e.clientX));
  addEventListener('mouseup',onUp);
  addEventListener('mouseleave',onUp);
  addEventListener('touchstart',e=>onDown(e.touches[0].clientX),{passive:true});
  addEventListener('touchmove',e=>onMove(e.touches[0].clientX),{passive:true});
  addEventListener('touchend',onUp);
  addEventListener('touchcancel',onUp);
  addEventListener('wheel',e=>{pan+=e.deltaY*0.5+e.deltaX;setTransforms();},{passive:true});

  setTransforms();
})();
</script>
</body>
</html>
